{"version":3,"file":"js/2194.27e9ce53.js","mappings":"+PAIqBA,EAAAA,W,yEAKnB,SAAgBC,GACd,OAAOC,EAAAA,EAAAA,YAAO,CACZC,OAAQ,OACRC,IAAK,oBACLC,KAAM,CACJC,MAAOL,EAAKK,MACZC,SAAUN,EAAKM,SACfC,SAAUP,EAAKO,SACfC,UAAWR,EAAKS,SAChBC,iBAAkBV,EAAKW,iBAEzBC,aAAa,GAEhB,G,wEASD,WAAsBN,EAAUC,EAAUM,EAASC,GAAnD,wGACuBb,EAAAA,EAAAA,YAAO,CAC1BE,IAAK,iBACLD,OAAQ,OACRE,KAAM,CACJS,QAAAA,EACAP,SAAAA,EACAC,SAAAA,GAEFQ,QAAS,CACPD,IAAAA,KAVN,cACQE,EADR,QAaEC,EAAAA,EAAAA,YAAWD,EAAOE,aAAcF,EAAOG,eAbzC,kBAcSH,GAdT,2C,8IAoBA,uHACqBI,EAAAA,EAAAA,KAAI,wBADzB,cACQC,EADR,OAEQC,EAAmC,OAAvBC,EAAAA,WAAAA,QAAAA,KAA8B,CAAC,EAAIA,EAAAA,WAAAA,QAAAA,KAFvD,kBAGSC,OAAOC,QAAP,UAAmBH,GAAaD,IAHzC,2C,uIASA,uHACqBD,EAAAA,EAAAA,KAAI,wBADzB,cACQC,EADR,OAEQC,EAAmC,OAAvBC,EAAAA,WAAAA,QAAAA,KAA8B,CAAC,EAAIA,EAAAA,WAAAA,QAAAA,KAFvD,kBAGSC,OAAOC,QAAP,UAAmBH,GAAaD,IAHzC,2C,qFAaA,YAAwE,IAAhDK,EAAgD,EAAhDA,aAAcC,EAAkC,EAAlCA,aAAcjB,EAAoB,EAApBA,iBAClD,OAAOkB,EAAAA,EAAAA,KAAI,2BAA4B,CACrCD,aAAAA,EACAjB,iBAAAA,EACAgB,aAAAA,GAEH,K,EA3EkB3B,E","sources":["webpack://lin-cms-vue/./src/lin/model/user.js"],"sourcesContent":["import store from '@/store'\r\nimport _axios, { get, put } from '@/lin/plugin/axios'\r\nimport { saveTokens } from '../util/token'\r\n\r\nexport default class User {\r\n  /**\r\n   * 分配用户\r\n   * @param {object} user 注册信息\r\n   */\r\n  static register(user) {\r\n    return _axios({\r\n      method: 'post',\r\n      url: 'cms/user/register',\r\n      data: {\r\n        email: user.email,\r\n        username: user.username,\r\n        password: user.password,\r\n        group_ids: user.groupIds,\r\n        confirm_password: user.confirmPassword,\r\n      },\r\n      handleError: true,\r\n    })\r\n  }\r\n\r\n  /**\r\n   * 登陆获取tokens\r\n   * @param { String } username 用户名\r\n   * @param { String } password 密码\r\n   * @param { String } captcha 验证码\r\n   * @param { String } tag 验证码签名\r\n   */\r\n  static async getToken(username, password, captcha, tag) {\r\n    const tokens = await _axios({\r\n      url: 'cms/user/login',\r\n      method: 'POST',\r\n      data: {\r\n        captcha,\r\n        username,\r\n        password,\r\n      },\r\n      headers: {\r\n        tag,\r\n      },\r\n    })\r\n    saveTokens(tokens.access_token, tokens.refresh_token)\r\n    return tokens\r\n  }\r\n\r\n  /**\r\n   * 获取当前用户信息，并返回User实例\r\n   */\r\n  static async getInformation() {\r\n    const info = await get('cms/user/information')\r\n    const storeUser = store.getters.user === null ? {} : store.getters.user\r\n    return Object.assign({ ...storeUser }, info)\r\n  }\r\n\r\n  /**\r\n   * 获取当前用户信息和所拥有的权限\r\n   */\r\n  static async getPermissions() {\r\n    const info = await get('cms/user/permissions')\r\n    const storeUser = store.getters.user === null ? {} : store.getters.user\r\n    return Object.assign({ ...storeUser }, info)\r\n  }\r\n\r\n  /**\r\n   * 用户修改密码\r\n   * @param {string} newPassword 新密码\r\n   * @param {string} confirmPassword 确认新密码\r\n   * @param {string} oldPassword 旧密码\r\n   */\r\n  // eslint-disable-next-line camelcase\r\n  static updatePassword({ old_password, new_password, confirm_password }) {\r\n    return put('cms/user/change_password', {\r\n      new_password,\r\n      confirm_password,\r\n      old_password,\r\n    })\r\n  }\r\n}\r\n"],"names":["User","user","_axios","method","url","data","email","username","password","group_ids","groupIds","confirm_password","confirmPassword","handleError","captcha","tag","headers","tokens","saveTokens","access_token","refresh_token","get","info","storeUser","store","Object","assign","old_password","new_password","put"],"sourceRoot":""}