{"version":3,"file":"js/5639.0f5f8e82.js","mappings":"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","sources":["webpack://lin-cms-vue/./src/view/admin/group/group-create.vue","webpack://lin-cms-vue/./src/view/admin/group/group-create.vue?a532"],"sourcesContent":["<template>\r\n  <div class=\"container\">\r\n    <div class=\"title\">新建分组信息</div>\r\n    <el-row>\r\n      <el-col :lg=\"16\" :md=\"20\" :sm=\"24\" :xs=\"24\">\r\n        <div class=\"content\">\r\n          <el-form\r\n            ref=\"form\"\r\n            status-icon\r\n            :rules=\"rules\"\r\n            :model=\"group\"\r\n            label-position=\"right\"\r\n            label-width=\"100px\"\r\n            v-loading=\"loading\"\r\n            @submit.prevent\r\n          >\r\n            <el-form-item label=\"分组名称\" prop=\"name\">\r\n              <el-input clearable v-model=\"group.name\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"分组描述\" prop=\"info\">\r\n              <el-input clearable v-model=\"group.info\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item>\r\n              <group-permissions title=\"分配权限\" ref=\"groupPermissions\" @updatePermissions=\"updatePermissions\">\r\n              </group-permissions>\r\n            </el-form-item>\r\n            <el-form-item class=\"submit\">\r\n              <el-button type=\"primary\" @click=\"submitForm('form')\">保 存</el-button>\r\n              <el-button @click=\"resetForm('form')\">重 置</el-button>\r\n            </el-form-item>\r\n          </el-form>\r\n        </div>\r\n      </el-col>\r\n    </el-row>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { useRouter } from 'vue-router'\r\nimport { ref, reactive } from 'vue'\r\nimport { ElMessage } from 'element-plus'\r\nimport AdminModel from '@/lin/model/admin'\r\nimport GroupPermissions from './group-permission'\r\n\r\nexport default {\r\n  components: {\r\n    GroupPermissions,\r\n  },\r\n  setup() {\r\n    /**\r\n     * 表单验证规则\r\n     */\r\n    const { rules } = getRules()\r\n\r\n    // originally data properties\r\n    const form = ref(null)\r\n    const groupPermissions = ref(null)\r\n\r\n    const loading = ref(false)\r\n    const router = useRouter()\r\n    const permissions = ref([])\r\n    const allPermissions = ref([])\r\n    const group = reactive({ name: '', info: '' })\r\n\r\n    /**\r\n     * 重置表单\r\n     */\r\n    const resetForm = () => {\r\n      form.value.resetFields()\r\n      groupPermissions.value.getGroupPermissions()\r\n    }\r\n\r\n    /**\r\n     * 提交表单\r\n     * 添加新的分组\r\n     */\r\n    const submitForm = async () => {\r\n      form.value.validate(async valid => {\r\n        if (valid) {\r\n          let res = {}\r\n          const finalPermissions = permissions.value.filter(x => Object.keys(allPermissions.value).indexOf(x) < 0)\r\n          try {\r\n            loading.value = true\r\n            res = await AdminModel.createOneGroup(group.name, group.info, finalPermissions)\r\n          } catch (e) {\r\n            loading.value = false\r\n            console.error(e)\r\n          }\r\n          if (res.code < window.MAX_SUCCESS_CODE) {\r\n            loading.value = false\r\n            ElMessage.success(`${res.message}`)\r\n            router.push('/admin/group/list')\r\n            resetForm()\r\n          } else {\r\n            loading.value = false\r\n          }\r\n        } else {\r\n          ElMessage.error('请将信息填写完整')\r\n        }\r\n      })\r\n    }\r\n\r\n    /**\r\n     * 编辑后的最终权限\r\n     */\r\n    const updatePermissions = picked => {\r\n      permissions.value = picked\r\n    }\r\n\r\n    return {\r\n      form,\r\n      rules,\r\n      group,\r\n      loading,\r\n      resetForm,\r\n      submitForm,\r\n      groupPermissions,\r\n      updatePermissions,\r\n    }\r\n  },\r\n}\r\n\r\nfunction getRules() {\r\n  const checkName = (rule, value, callback) => {\r\n    if (!value) {\r\n      return callback(new Error('分组名称不能为空'))\r\n    }\r\n    callback()\r\n  }\r\n  const rules = { info: [], name: [{ validator: checkName, trigger: ['blur', 'change'], required: true }] }\r\n  return { rules }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.container {\r\n  .title {\r\n    height: 59px;\r\n    line-height: 59px;\r\n    color: $parent-title-color;\r\n    font-size: 16px;\r\n    font-weight: 500;\r\n    text-indent: 40px;\r\n    border-bottom: 1px solid #dae1ec;\r\n  }\r\n\r\n  .content {\r\n    margin-top: 10px;\r\n    padding-left: 25px;\r\n    padding-right: 40px;\r\n  }\r\n\r\n  .submit {\r\n    float: left;\r\n  }\r\n}\r\n</style>\r\n","import { render } from \"./group-create.vue?vue&type=template&id=dea61f72&scoped=true\"\nimport script from \"./group-create.vue?vue&type=script&lang=js\"\nexport * from \"./group-create.vue?vue&type=script&lang=js\"\n\nimport \"./group-create.vue?vue&type=style&index=0&id=dea61f72&lang=scss&scoped=true\"\n\nimport exportComponent from \"E:\\\\postgraduatecode\\\\lin-cms-vue\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-dea61f72\"]])\n\nexport default __exports__"],"names":["class","lg","md","sm","xs","ref","rules","model","group","label","prop","clearable","name","info","title","updatePermissions","type","submitForm","resetForm","loading","components","GroupPermissions","setup","getRules","form","groupPermissions","router","permissions","allPermissions","value","resetFields","getGroupPermissions","validate","valid","res","finalPermissions","filter","x","Object","keys","indexOf","console","error","code","window","MAX_SUCCESS_CODE","message","push","picked","checkName","rule","callback","Error","validator","trigger","required","__exports__","render"],"sourceRoot":""}